{% extends "base.html" %}

{% block title %}AP Aging - Mohi Industries ERP{% endblock %}

{% block content %}
<div class="flex justify-between items-center mb-6">
    <div>
        <h2 class="text-3xl font-display font-bold text-gray-900">Accounts Payable Aging</h2>
        <p class="text-gray-500 mt-1">As on {{ as_on }}</p>
    </div>
    <div class="flex space-x-2">
        <a href="{{ url_for('accounting.export_ap_aging_excel', as_on=as_on) }}" class="bg-emerald-500 hover:bg-emerald-600 text-white px-4 py-2 rounded transition inline-flex items-center">
            üìä Export Excel
        </a>
        <a href="{{ url_for('accounting.print_ap_aging', as_on=as_on) }}" target="_blank" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded transition inline-flex items-center">
            üñ®Ô∏è Print
        </a>
        <a href="{{ url_for('accounting.dashboard') }}" class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded transition">
            ‚Üê Dashboard
        </a>
    </div>
</div>

<div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
    {% for label, value in buckets.items() %}
    <div class="bg-white rounded-lg shadow p-4">
        <p class="text-sm text-gray-500">{{ label }} days</p>
        <p class="text-xl font-bold text-gray-800">‚Çπ{{ "%.2f"|format(value) }}</p>
    </div>
    {% endfor %}
</div>

<div class="bg-white rounded-xl shadow-soft border border-gray-100 overflow-hidden">
    <table class="min-w-full divide-y divide-gray-200">
        <thead class="bg-gray-50">
            <tr>
                <th class="px-4 py-3 text-left text-xs font-semibold text-gray-500 uppercase">Vendor</th>
                <th class="px-4 py-3 text-right text-xs font-semibold text-gray-500 uppercase">0-30</th>
                <th class="px-4 py-3 text-right text-xs font-semibold text-gray-500 uppercase">31-60</th>
                <th class="px-4 py-3 text-right text-xs font-semibold text-gray-500 uppercase">61-90</th>
                <th class="px-4 py-3 text-right text-xs font-semibold text-gray-500 uppercase">90+</th>
                <th class="px-4 py-3 text-right text-xs font-semibold text-gray-500 uppercase">Total</th>
            </tr>
        </thead>
        <tbody class="divide-y divide-gray-200">
            {% for row in rows %}
            <tr>
                <td class="px-4 py-3 text-sm">{{ row.vendor.business_name }}</td>
                <td class="px-4 py-3 text-sm text-right font-mono">‚Çπ{{ "%.2f"|format(row['0-30']) }}</td>
                <td class="px-4 py-3 text-sm text-right font-mono">‚Çπ{{ "%.2f"|format(row['31-60']) }}</td>
                <td class="px-4 py-3 text-sm text-right font-mono">‚Çπ{{ "%.2f"|format(row['61-90']) }}</td>
                <td class="px-4 py-3 text-sm text-right font-mono">‚Çπ{{ "%.2f"|format(row['90+']) }}</td>
                <td class="px-4 py-3 text-sm text-right font-mono font-semibold">‚Çπ{{ "%.2f"|format(row.total) }}</td>
            </tr>
            {% endfor %}
            {% if rows|length == 0 %}
            <tr>
                <td colspan="6" class="px-6 py-10 text-center text-gray-500">No outstanding payables.</td>
            </tr>
            {% endif %}
        </tbody>
    </table>
</div>
{% endblock %}
