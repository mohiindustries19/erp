{% extends "base.html" %}

{% block title %}Trial Balance - Mohi Industries ERP{% endblock %}

{% block content %}
<div class="mb-6 flex justify-between items-center">
    <div>
        <h2 class="text-3xl font-display font-bold text-gray-900">Trial Balance</h2>
        <p class="text-gray-500 mt-1">{{ start_date }} to {{ end_date }}</p>
    </div>
    <div class="flex space-x-2">
        <form method="POST" action="{{ url_for('accounting.email_trial_balance') }}" class="flex items-center space-x-2">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
            <input type="hidden" name="start_date" value="{{ start_date if start_date is string else start_date.strftime('%Y-%m-%d') }}">
            <input type="hidden" name="end_date" value="{{ end_date if end_date is string else end_date.strftime('%Y-%m-%d') }}">
            <input type="email" name="email" placeholder="Email (optional)" class="px-3 py-2 border border-gray-300 rounded text-sm w-56" />
            <button type="submit" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded transition inline-flex items-center">
                ‚úâÔ∏è Email
            </button>
        </form>
        <a href="{{ url_for('accounting.export_trial_balance_excel', start_date=start_date, end_date=end_date) }}" class="bg-emerald-500 hover:bg-emerald-600 text-white px-4 py-2 rounded transition inline-flex items-center">
            üìä Export Excel
        </a>
        <a href="{{ url_for('accounting.print_trial_balance', start_date=start_date, end_date=end_date) }}" target="_blank" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded transition inline-flex items-center">
            üñ®Ô∏è Print
        </a>
    </div>
</div>

<div class="bg-white rounded-xl shadow-soft border border-gray-100 overflow-hidden">
    <table class="min-w-full divide-y divide-gray-200">
        <thead class="bg-gray-50">
            <tr>
                <th class="px-4 py-3 text-left text-xs font-semibold text-gray-500 uppercase">Account</th>
                <th class="px-4 py-3 text-right text-xs font-semibold text-gray-500 uppercase">Opening</th>
                <th class="px-4 py-3 text-right text-xs font-semibold text-gray-500 uppercase">Debit</th>
                <th class="px-4 py-3 text-right text-xs font-semibold text-gray-500 uppercase">Credit</th>
                <th class="px-4 py-3 text-right text-xs font-semibold text-gray-500 uppercase">Closing (Dr)</th>
                <th class="px-4 py-3 text-right text-xs font-semibold text-gray-500 uppercase">Closing (Cr)</th>
            </tr>
        </thead>
        <tbody class="divide-y divide-gray-200">
            {% for row in rows %}
            <tr>
                <td class="px-4 py-3 text-sm">
                    <a href="{{ url_for('accounting.account_ledger', account_id=row.account.id) }}" class="text-primary-600 hover:text-primary-800">
                        {{ row.account.name or row.account.account_name }}
                    </a>
                </td>
                <td class="px-4 py-3 text-sm text-right font-mono">‚Çπ{{ "%.2f"|format(row.opening) }}</td>
                <td class="px-4 py-3 text-sm text-right font-mono">‚Çπ{{ "%.2f"|format(row.debit) }}</td>
                <td class="px-4 py-3 text-sm text-right font-mono">‚Çπ{{ "%.2f"|format(row.credit) }}</td>
                <td class="px-4 py-3 text-sm text-right font-mono">‚Çπ{{ "%.2f"|format(row.debit_balance) }}</td>
                <td class="px-4 py-3 text-sm text-right font-mono">‚Çπ{{ "%.2f"|format(row.credit_balance) }}</td>
            </tr>
            {% endfor %}
        </tbody>
        <tfoot class="bg-gray-50">
            <tr>
                <th class="px-4 py-3 text-left text-xs font-semibold text-gray-500 uppercase">Totals</th>
                <th class="px-4 py-3"></th>
                <th class="px-4 py-3"></th>
                <th class="px-4 py-3"></th>
                <th class="px-4 py-3 text-right text-xs font-semibold text-gray-700 uppercase">‚Çπ{{ "%.2f"|format(total_debit) }}</th>
                <th class="px-4 py-3 text-right text-xs font-semibold text-gray-700 uppercase">‚Çπ{{ "%.2f"|format(total_credit) }}</th>
            </tr>
        </tfoot>
    </table>
</div>
{% endblock %}
